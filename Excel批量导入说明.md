# Excel 批量导入说明

## 📋 支持的导入格式

### 📊 完整格式（推荐）
包含物料信息 + 库存数据的完整导入模板：

**CSV 和 Excel 格式表头：**
```
序号,物料名称,标签,基本计量单位,物料单位,昨日库存,今日入库,车间出库,店面出库,今日库存,日期
```

**JSON 格式结构：**
```json
{
  "materials": [/* 物料数组 */],
  "records": [/* 库存记录数组 */]
}
```

### 🏷️ 简化格式
仅包含基本物料信息：

**CSV 格式表头：**
```
名称,单位,规格,分类,标签
```

## 📁 模板文件

1. **`Excel导入模板.csv`** - CSV 格式模板（推荐）
2. **`Excel导入模板.json`** - JSON 格式模板（推荐）
3. **`Excel导入模板.xlsx`** - Excel 格式模板（推荐）⭐
4. **`批量导入模板.csv`** - 简化格式 CSV 模板
5. **`批量导入模板.json`** - 简化格式 JSON 模板

## 🎯 完整格式使用方法

### CSV 和 Excel 文件示例
**CSV 格式：**
```csv
序号,物料名称,标签,基本计量单位,物料单位,昨日库存,今日入库,车间出库,店面出库,今日库存,日期
1,特级面粉,重要原料,kg,25kg/袋,100,50,20,10,120,2025-12-23
2,花生油,液态调味品,L,5L/桶,80,30,15,5,90,2025-12-23
```

**Excel 格式：**
| 序号 | 物料名称 | 标签 | 基本计量单位 | 物料单位 | 昨日库存 | 今日入库 | 车间出库 | 店面出库 | 今日库存 | 日期 |
|------|----------|------|--------------|----------|----------|----------|----------|----------|----------|------|
| 1    | 特级面粉 | 重要原料 | kg        | 25kg/袋  | 100      | 50       | 20       | 10       | 120   | 2025-12-23 |
| 2    | 花生油   | 液态调味品 | L         | 5L/桶    | 80       | 30       | 15       | 5        | 90    | 2025-12-23 |

### JSON 文件示例
```json
{
  "materials": [
    {
      "name": "特级面粉",
      "unit": "kg",
      "spec": "25kg/袋", 
      "category": "食材",
      "tags": "重要原料"
    }
  ],
  "records": [
    {
      "materialName": "特级面粉",
      "date": "2025-12-23",
      "yesterdayStock": 100,
      "todayIn": 50,
      "workshopOut": 20,
      "storeOut": 10,
      "currentStock": 120
    }
  ]
}
```

## 📝 字段说明

### 物料信息字段
- **序号**：记录序号（自动生成）
- **物料名称/名称**：物料名称（必填）
- **标签**：物料标签（可选）
- **基本计量单位/单位**：基本计量单位（必填）
- **物料单位/规格**：物料规格说明（可选，默认使用物料名称）
- **分类**：物料分类（可选，默认"其他"）

### 库存数据字段
- **昨日库存**：昨日结余数量（可选，默认0）
- **今日入库**：今日入库数量（可选，默认0）
- **车间出库**：车间出库数量（可选，默认0）
- **店面出库**：店面出库数量（可选，默认0）
- **今日库存**：当前库存数量（可选，自动计算）

## 🔄 自动计算

如果提供 `昨日库存、今日入库、车间出库、店面出库`，系统会自动计算：
```
实时库存 = 昨日库存 + 今日入库 - 车间出库 - 店面出库
```

如果同时提供了 CSV 中的实时库存，系统会优先使用 CSV 中的值。

## 🚀 导入步骤

1. **准备数据文件**
   - 使用提供的模板文件
   - 填写您的物料和库存数据
   - 保存为 `.csv` 或 `.json` 格式

2. **执行导入**
   - 登录系统 → "实时仓库管理"
   - 点击上传图标 (FileUp)
   - 选择准备好的文件
   - 确认导入结果

3. **验证数据**
   - 检查物料是否正确导入
   - 核实库存数据是否准确
   - 查看操作日志确认导入记录

## ⚠️ 注意事项

1. **物料名称匹配**：JSON 格式中，库存记录通过 `materialName` 与物料信息关联
2. **日期格式**：库存记录日期格式为 `YYYY-MM-DD`，不填写则使用当前系统日期
3. **数据验证**：导入前请检查必填字段是否完整
4. **重复导入**：系统会为每次导入的物料生成新的唯一ID
5. **编码格式**：CSV 文件请使用 UTF-8 编码

## 🔧 故障排除

**导入失败检查清单：**
- ✅ 文件格式正确（CSV/JSON）
- ✅ 必填字段完整（物料信息、计量单位）
- ✅ CSV 文件使用 UTF-8 编码
- ✅ JSON 语法正确
- ✅ 数值字段为有效数字
- ✅ 库存数据计算关系正确

**常见问题：**
- **物料名称不匹配**：检查 JSON 格式中的 `materialName` 是否与物料名称完全一致
- **库存计算错误**：核实库存字段的数值关系
- **编码问题**：用文本编辑器确认文件编码为 UTF-8